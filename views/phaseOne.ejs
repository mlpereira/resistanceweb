<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Resistance Web</title>
    <link rel="stylesheet" href="/stylesheets/index.css" />
  </head>
  <body>
    Player: <%= player.name+' ID: '+player.id+(player.isLoyal ? ' Loyal' : ' Spy') %>
    <% var mission = room.getCurrentMission(); %>
    <% if (!mission.firstTeam) { %>
    <fieldset>
        <legend>Mission <%= room.currentMissionIndex+1 %></legend>
        <h1>TEAM REJECTED</h1>
        <h3>Leader:</h3>
        <li><%= mission.lastLeader.name %></li>
        <h3>Agents:</h3>
        <% for (var i=0; i<mission.lastAgents.length; i++) { %>
          <li><%= mission.lastAgents[i].name %></li>
        <% } %>
    </fieldset>
    <% } %>
    <fieldset>
      <% var leader = room.getCurrentLeader() %>
      <% if (leader.id == player.id) { %>
        You are the leader.
        Select who you want to send.
      <% } else { %>
        Leader <%= leader.name %> is choosing who he is going to send
      <% } %>
    </fieldset>
    <form action=<%= room.id + "/selectAgents" %> method="post">
      <ul>
      <% for (var i=0; i<room.players.length; i++) { %>
        <% var p = room.players[i]; %>
        <li>
          <% if (leader.id == player.id) { %>
            <input type="checkbox" name="agents[]" value=<%= i %>>
          <% } %>
          <%= p.name %>
          <% if (!mission.firstTeam) { %>
            (Vote for last team: <%= mission.lastVotes[p.id] %>)
          <% } %>
        </li>
      <% } %>
      <% if (leader.id == player.id) { %>
        <button type="submit">Confirm Agents</button>
      <% } %>
    </ul>
    </form>
  </body>
</html>
